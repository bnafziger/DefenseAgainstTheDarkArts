<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=1"/>
<link rel="stylesheet" href="../stylesheets/style.css" />
<title>COMP 116: Introduction to Computer Security - Forensics, Anti-Forensics, Incident Handling</title>
</head>

<body>
<h1>COMP 116: Introduction to Computer Security</h1>
<h2>Forensics, Anti-Forensics, Incident Handling</h2>

<h3>Why Forensics?</h3>
<ul>
<li>E-mail</li>
<li>Child pornography</li>
<li>Sexting</li>
<li>Fraud (especially financial)</li>
<li>Intellectual property theft</li>
</ul>

<h3>What is Computer Forensics?</h3>
<ul>
<li>Preservation (of computer media)</li>
<li>Identification (of computer media)</li>
<li>Extraction (of computer media)</li>
<li>Interpretation</li>
<li>Documentation</li>
</ul>

<h3>Process</h3>
<ol>
<li>Assess the situation</li>
<li>Acquire data</li>
<li>Analyze data</li>
<li>Report</li>
</ol>

<h3>Terminology</h3>
<ul>
	<li><span class="def">Volatile</span></li>
	<li><span class="def">Non-volatile</span></li>
	<li><span class="def">Physical acquisition</span> - bit-by-bit copy of entire physical store</li>
	<li><span class="def">Logical acquisition</span> - bit-by-bit copy of directories and files on a file system partition</li>
	<li><scan class="def">Chain-of-custody</span> - chronological documentation from "crade-to-grave" (i.e., seizre, custody, control, transfer, analysis, disposal)</li>
</ul>

<h3>Step 1: Assess the Situation</h3>
<ul>
<li>Obtain proper authorization</li>
<li>Notify decision makers (e.g., Human Resources)</li>
<li>Identify investigation team members</li>
<li>Conduct thorough assessment</li>
<li>Review policies and laws (local, state, and federal)</li>
<li>Decide whether to involve law enforcement. For some incidents (e.g., child pornography, death threats), law enforcement involvement is required.</li>
<li>Conduct interviews</li>
<li>Prepare for evidence acquisition</li>
</ul>

<h3>Step 2: Acquire Data</h3>
<ul>
<li>Build toolkit, jump-bag of tools</li>
<li>Determine whether a rootkit has been installed on systems</li>
<li>Start log of actions</li>
<li>Identify and document potential sources of data</li>
<li>Collect volatile and non-volatile data.  Volatile evidence (e.g., memory, running processes) can be easily destroyed/</li>
<li>Store evidence in a secure and tamperproof location</li>
</ul>

<h3>Step 3: Analyze Data</h3>
<ul>
<li>Examine network data (e.g., logs, firewall, IDS, packets)</li>
<li>Whenever possible, perform offline analysis on bit-wise copy of the original evidence</li>
<li>Determine if encryption was used</li>
<li>Uncompress any compressed files or archives</li>
<li>Create diagram of directory structure</li>
<li>Examine Windows registry (if applicable)</li>
<li>Search contents of all gathered files</li>
<li>Study the metadata of files</li>
</ul>

<h3>Step 4: Report</h3>
<ul>
<li>Gather all documentation and notes from steps 1-3</li>
<li>Create outline of documentation that are relevant to investigation</li>
<li>Identify the facts</li>
<li>Create a list of all evidence to be enclosed with report</li>
<li>List conclusions</li>
<li>Typical format of report:
<ul>
<li>Purpose</li>
<li>Authors</li>
<li>Incident Summary</li>
<li>Evidence</li>
<li>Details</li>
<li>Conclusions</li>
<li>Enclosures and supporting documents</li>
</ul>
</li>
</ul>

<h3>Working with Volatile Data</h3>
<ul>
<li>Processes</li>
<li>Memory (see <code>/dev/mem</code>)</li>
</ul>

<h3>Tools</h3>
<ul>
<li><code>strings</code></li>
<li><code><a href="http://en.wikipedia.org/wiki/Dd_(Unix)" target="_blank">dd</a></code> (convert-and-copy)</li>
<li><a href="http://accessdata.com/solutions/digital-forensics/forensic-toolkit-ftk?/solutions/digital-forensics/ftk" target="_blank">FTK</a></li>
<li><a href="https://www.guidancesoftware.com/" target="_blank">Encase</a></li>
<li><a href="https://cofee.nw3c.org/" target="_blank">Microsoft COFEE</a> <span class="note">(for law enforcement only)</span></li>
<li><a href="https://github.com/abeluck/stegdetect" target="_blank">stegdetect</a></li>
<li><a href="http://www.sleuthkit.org/" target="_blank">Sleuthkit and Autopsy</a></li>
</ul>

<h3>Anti-Forensics</h3>
<ul>
<li><a href="http://www.wired.com/2009/12/decaf-cofee/" target="_blank">DECAF</a> <span class="note">(no longer available)</span></li>
<li>Steganography
<ul>
<li><a href="http://steghide.sourceforge.net/" target="_blank">steghide</a></li>
<li><a href="http://www.crazyboy.com/hydan/" target="_blank">Hydan</a></li>
<li><a href="http://www.guillermito2.net/stegano/jsteg/index.html" target="_blank">jsteg</a></li>
</ul>
</li>
<li>Remove or wipe out logs</li>
<li>Encryption (e.g., <a href="http://www.truecrypt.org/" target="_blank">TrueCrypt</a>)</li>
</ul>

<h3>Incident Handling. Or Why Incident Handling?</h3>
<ul>
<li>Chaos</li>
<li>Barking up the wrong trees</li>
<li>Dead-end investigations</li>
<li>Hard to accumulate knowledge, experience</li>
<li>Legal issues</li>
<li>Cost overruns</li>
<li>Organization (i.e., do not know who to contact)</li>
</ul>

<h3>Part 1: Preparation</h3>
<ul>
<li>The security policy</li>
<li>Learn about your environment, system architectures</li>
<li>Train and educate employees</li>
<li>Identify tools, create a jump bag ready-to-go (e.g., BackTrack DVD, extra ethernet cables, static-free bags, a notebook)</li>
<li>Identify contacts and owners</li>
</ul>

<h3>Part 2: Identification</h3>
<ul>
<li>The first report of incident</li>
<li>Start recordkeeping</li>
<li>Collect information, logs</li>
</ul>

<h3>Log Analysis (Unixland)</h3>
<ul>
<li>Format: <code>date/time host message_source message</code></li>
<li><code>syslog</code></li>
<li>Default location of logs in filesystem: <code>/var/log</code></li>
<li>Configuration (e.g., log to a server): <code>/etc/syslog.conf</code></li>
<li>Problems:
<ul>
<li>Inconsistent format among platforms (other than date/time)</li>
<li>Can be deleted, modified by attacker</li>
<li>Can be HUGE!</li>
</ul>
</li>
<li>In Windows: use eventviewer</li>
<li>Remember: <span class="stress">If an event is not logged, then you cannot analyze it!</span></li>
</ul>

<h3>Part 3: Containment</h3>
<ul>
<li>Limit damage</li>
<li>Keep evidence in tact</li>
<li>Backup</li>
<li>Determine whether to continue operations</li>
</ul>

<h3>Part 4: Eradication</h3>
<ul>
<li>Eliminate incident</li>
<li>Change passwords</li>
<li>Perhaps migrate system to new architecture</li>
<li>Restore from last good backup or reinstall clean operating system</li>
<li>Secure wipe hard drives (see <a href="http://www.dss.mil/documents/odaa/nispom2006-5220.pdf" target="_blank">US Department of Defense 5220.22-M</a>)</li>
</ul>

<h3>Part 5: Recovery</h3>
<ul>
<li>Return to normal</li>
<li>Increase monitoring (e.g., Tripwire)</li>
<li>Test new controls</li>
</ul>

<h3>Part 6: Lessons Learned</h3>
<ul>
<li>Follow-up</li>
<li>Summary to management</li>
<li>Write newsletter to employees, public</li>
</ul>

<h3>Forensics vs. Incident Handling</h3>
<ul>
<li>There are overlaps</li>
<li>Forensics: "finding and documenting the actions of a person or persons in relation to other people or places or activities.  Must have a strong understanding of where and how data is stored, how data is created, how to recover that data in a forensically sound manner and how to analyze the recovered data.""</li>
<li>Incident Handling: generally speaking, must be well versed with many facets of IT and information security.</li>
<li>Source: <a href="http://exforensis.blogspot.com/2009/09/how-is-computer-forensics-different.html" target="_blank">http://exforensis.blogspot.com/2009/09/how-is-computer-forensics-different.html</a></li>
</ul>
</body>
</html>
